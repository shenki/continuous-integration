language: cpp
matrix:
  include:
    # linux
    - name: "ARCH=arm32_v5"
      env: ARCH=arm32_v5
    - name: "ARCH=arm32_v6"
      env: ARCH=arm32_v6
    - name: "ARCH=arm32_v7"
      env: ARCH=arm32_v7
    # linux-next (cron only)
    - name: "ARCH=arm32_v5 REPO=linux-next"
      env: ARCH=arm32_v5 REPO=linux-next
    - name: "ARCH=arm32_v6 REPO=linux-next"
      env: ARCH=arm32_v6 REPO=linux-next
    - name: "ARCH=arm32_v7 REPO=linux-next"
      env: ARCH=arm32_v7 REPO=linux-next
compiler: gcc
os: linux
dist: trusty
sudo: required
cache:
  directories:
    - .ccache
services:
  - docker
script:
  - |
    docker run \
        --env ARCH=${ARCH} \
        --env LD=${LD} \
        --env REPO=${REPO} \
        --rm \
        --workdir /travis \
        --volume ${TRAVIS_BUILD_DIR}:/travis \
        clangbuiltlinux/ubuntu /bin/bash -c './env-setup.sh && ./driver.sh && ccache -s'
after_script:
  - sleep 1
notifications:
  email:
    receipients:
      - ndesaulniers@google.com
      - natechancellor@gmail.com
    on_success: never
    on_failure: always
